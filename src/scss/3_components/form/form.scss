/*
 * @file
 * Provides the generic styling for all types of form components.
 */
@import '../../init';
@import 'button/button-defs';

main form {
  margin: 0;
  padding: 0;
  max-width: 800px;

  .form-actions {
    margin: 2.5em 0;
  }

  .form-item {
    position: relative;
  }

  & > .form-item,
  .form-wrapper > .form-item {
    padding: 0;
    margin: 0 0 2em;
  }

  .description {
    @include rhythm-margins(1, 1.66667);
    @include adjust-font-size-to(13px, 2.6667);
    @include breakpoint($phab, $no-query: true) {
      @include adjust-font-size-to(15px, 3);
    }
  }

  fieldset,
  .fieldset {
    border: 0;
    padding: 0;

    &:first-child {
      margin-top: 0;
    }

    &:focus {
      outline-color: $brand-primary-medium;
      border: 0;
    }

    & + div.form-item {
      margin-top: -.5em !important;
    }

    & > .form-item {
      margin: 1em 0 0 0;
    }
  }

  legend,
  fieldset h2,
  .fieldset h2 {
    @include responsive-typo-map($form-legend);
    color: $brand-primary-dark;
    font-weight: normal;
  }

  label, span.label {

    @include responsive-typo-map($body-text);

    font-weight: normal;

    & + .form-radios {
      margin-top: 3px;
      margin-top: .3rem;
      @include breakpoint($phab, $no-query: true) {
        margin-top: 6px;
        margin-top: .6rem;
      }
    }

    &.visually-hidden + .form-radios {
      margin-top: -4px;
      margin-top: -.4rem;
      @include breakpoint($phab, $no-query: true) {
        margin-top: -6px;
        margin-top: -.6rem;
      }
    }
  }

  select,
  [type='text'],
  [type='search'],
  [type='tel'],
  [type='url'],
  [type='email'],
  [type='password'],
  [type='date'],
  [type='time'],
  [type='number'],
  textarea {
    box-sizing: border-box;
    border: 1px solid #333;
    border-radius: 0;
    color: $charcoal;
    margin: .5em 0;
    padding: .6rem;
    min-height: 4.5rem;

    &:hover {
      border-color: $brand-primary-medium;
    }

    &:focus {
      box-shadow: none;
      color: $charcoal;
      outline: 3px solid $brand-primary-medium;
    }

    /* Highlight the form elements that caused a form submission error. */
    &.error,
    &.error:focus {
      border: 1px solid $error;
      outline-color: $error;
      background-color: $error-bg; // lightpink
      box-shadow: none;
      color: $charcoal;
    }
  }

  // Based on https://css-tricks.com/styling-a-select-like-its-2019/
  .form-select {
    display: block;
    font-size: 16px;
    font-family: sans-serif;
    font-weight: normal;
    color: $charcoal;
    line-height: 1.3;
    padding: .6em 1.4em .5em .8em;
    box-sizing: border-box;
    margin: rhythm(1) 0 0;
    border: 1px solid $grey-dark;
    border-radius: 0;
    appearance: none;
    background-color: #fff;
    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23666666%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #fff 0%, #e5e5e5 100%);
    background-repeat: no-repeat, repeat;
    background-position: right .7em top 50%, 0 0;
    background-size: .65em auto, 100%;

    @include breakpoint($phab, $no-query: true) {
      font-size: 18px;
      line-height: 1.5;
      height: 2.5em;
      padding: .5em 1.3334em .5em .6667em;
    }
  }

  .form-select::-ms-expand {
    display: none;
  }

  .form-select option {
    font-weight: normal;
  }

  textarea,
  .form-textarea {
    width: 100%;
    line-height: 1.5;
  }

  .form-type-radio {
    position: relative;
  }

  input[type="checkbox"] {
    border-radius: 0;
  }

  input[type="radio"], .form-radio, input[type="checkbox"], .form-checkbox {

    @include breakpoint($phab, $no-query: true) {
      @include adjust-font-size-to(18px, 4);
    }

    @include adjust-font-size-to(16px, 4);

    // css trick to vertically center in parent div
    position: absolute;
    top: 50%;
    transform: translate(0,-50%);
    z-index: 1;
    left: 1rem;
    clear: both;
    margin: 0;
    padding: 0;
    max-width: 2rem;
    max-height: 2rem;
    line-height: 2.4rem;
    vertical-align: baseline;
    box-shadow: none;
    border: none;
    color: inherit;

    // sibling labels
    & ~ label {
      position: relative;
      left: 0;
      margin: .5em 0;
      padding: .9rem 1.5rem .9rem 3rem;
      @include adjust-font-size-to(16px, 4);
      display: inline-block;
      vertical-align: baseline;
      min-width: 7.5rem;
      border: 1px solid $grey;
      @include breakpoint($phab, $no-query: true) {
        @include adjust-font-size-to(18px, 4);
      }
    }

    &.error ~ label {
      border-color: $error;
      outline-color: $error !important;
      background-color: $error-bg;
      box-shadow: none;
      color: $charcoal;
    }

    &:hover:not(.error) ~ label {
      border-color: lighten($brand-primary-medium, 25%);
    }

    &:checked ~ label {
      background-color: $brand-primary-lightest;
    }

    &:focus ~ label {
      outline: 3px solid $brand-primary-medium;
      outline-offset: -2px;
    }
  }

  input[type="radio"], .form-radio {
    border: 2px solid $charcoal;
    border-radius: 50% !important;
    background-color: #fff;
    width: 1.6rem;
    height: 1.6rem;
    &:checked {
      background-color: #2daff7;
      border-style: inset;
    }
  }

  input[type="checkbox"], .form-checkbox {
    border: 2px solid $charcoal;
    border-radius: 0;
    background-color: #fff;
    width: 1.6rem;
    height: 1.6rem;
    &:checked {
      background-color: #2daff7;
      border-style: inset;
    }
  }

  input[type="submit"], input[type="button"], .webform-submit {
    @extend %btn;
    @include btn-color($btn-primary, #fff);
    @include btn-size('large');
    margin-top: 0;
    font-weight: bold;
  }
}

