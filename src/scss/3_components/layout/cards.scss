/*
 * @file
 * Provides the styling for creating a card component.
 */

@import '../../init';

// Card component
//
// A fairly simple component to group a number of related elements. It is envisaged that this component will frequently
// change state. These are dealt with in the states section of the theme.
//
// Style guide: components.layouts.cards
.card {
  &-deck {
    grid-template-columns: repeat(1, 1fr);

    $selector: ();
    $suffixes: ('top', 'bottom', 'left', 'right');
    // this declaration creates a number of modifier classes for a border on the `.card` children under `.card-deck`
    // one modifier for each item in the $suffixes list.
    @each $suffix in $suffixes {
      $selector: unquote('border-#{$suffix}');

      &.#{$selector} .card {
        #{$selector}: 1px solid;
      }
    }
  }

  &__title {
    margin-top: 0;
  }

  &__meta {
    @include adjust-font-size-to(15px, 3.6667);
    @include breakpoint($tab) {
      @include adjust-font-size-to(16px, 4);
    }
  }

  // Featured news card
  //
  // A specific card layout that takes .
  //
  // Style guide: components.layouts.cards.featured-news
  &--featured-news {
    display: grid;
    grid-template-columns: 100px auto;
    grid-gap: 0 1.2rem;
    max-width: 720px;
    margin-bottom: 2.4rem;

    @include breakpoint($mob) {
      grid-template-columns: 150px auto;
    }

    @include breakpoint($tab) {
      grid-gap: 0 1.5rem;
      margin-bottom: 2.7rem;
    }

    & > * {
      grid-column: 2;
      margin: 0;
    }

    .card {
      &__title {
        @include adjust-font-size-to(18px, 4);

        @include breakpoint($mob) {
          @include adjust-font-size-to(21px, 4.5);
        }
      }

      &__meta {
        color: $meta;
      }

      &__content {
        @include adjust-font-size-to(16px, 3.5);
        margin: .4rem 0;
        grid-column-start: 1;
        grid-column-end: 3;

        @include breakpoint($mob) {
          grid-column: 2;
        }

        @include breakpoint($mob) {
          margin: .6rem 0;
        }
      }

      &__image {
        grid-column: 1;
        grid-row: 1/10;

        img {
          width: 100%;
          margin: 0;
          float: none;
        }
      }
    }
  }
}


.card-deck-flex {

  // Deck of cards laid out using flex.
  display: flex;

  // Small screens - cards are stacked in single column.
  flex-flow: column nowrap;

  margin: 1.5em 0;

  @include breakpoint($tab, $no-query: true) {

    // Larger screens - tablet and up, cards go into rows.
    flex-flow: row wrap;
    justify-content: space-between;

    margin: 0 0 2.5em; // 36px @ 16px font size; 45px @ 18px font-size.
  }

  .card {

    position: relative; // For absolutely positioned child elements;

    // Simple card - image, title, teaser text, link.
    // On very small screens, everything in the card is stacked in a single column.
    display: flex;
    flex-flow: column nowrap;

    padding-bottom: .75em;
    margin-bottom: 1.5em;
    border: 0;
    box-shadow: 0 1px 2px $grey-medium;

    &:hover {
      background-color: $offwhite;
      border-color: $offwhite;
    }

    &__image,
    &__content {
      width: 100%;
    }

    &__content {
      padding: .75em;
    }

    // On medium screens, image to the left and other content to the right.
    @include breakpoint($mob, $no-query: true) {
      flex-direction: row;
      box-shadow: 1px 0 5px $grey-medium;
      padding: 0;
      margin-bottom: .75em;

      &__image {
        width: 38%;
        padding: .5em;
      }

      &__content {
        width: 62%;
        padding: .75em 1em .75em .5em;
      }
    }

    // On larger screens, card contents stacked single column again (cards themselves are in a multi-column layout).
    @include breakpoint($tab, $no-query: true) {
      flex-direction: column;
      border: 0;
      box-shadow: 0 1px 2px $grey-medium; // Using box-shadow instead of a border
      margin-bottom: 2.5em;

      &__image {
        width: 100%;
        padding: 0;
      }

      &__content {
        width: 100%;
        padding: .6667em;
      }
    }

    @include breakpoint($tab, $no-query: true) {

      &__content {
        padding: 1em;
      }
    }

    picture {
      width: 100%;
      height: auto;
      margin: 0;

      img {
        width: 100%;
        height: auto;
        margin: 0;
      }
    }

    &__content {

      > * {
        @include adjust-font-size-to(16px, 4);

        @include breakpoint($tab, $no-query: true) {
          @include adjust-font-size-to(18px, 4.5);
        }

        margin: 0 0 1em 0;

        &:last-child {
          margin-bottom: 0;
        }
      }

      li {
        position: relative;
        list-style: none;
        padding: 0 0 rhythm(1) 1rem;

        &::before {
          content: '-';
          position: absolute;
          left: 0;
          top: 0;
        }
      }

      iframe {
        margin: 0;
        border: 0;
      }
    }

    &__title {
      @include adjust-font-size-to(22px, 4.6667);
      margin: 0 0 .8rem;

      @include breakpoint($phab, $no-query: true) {
        @include adjust-font-size-to(24px, 5);
        margin: 0 0 .8rem;
      }

      @include breakpoint($tab, $no-query: true) {
        margin: 0 0 .9rem;
      }

      position: relative;
      padding-right: 25px;

      &::after {
        content: '';
        display: inline-block;
        position: absolute;
        top: 2px;
        right: -8px;
        width: 24px;
        height: 20px;
        background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2025%2015%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%20.st0%7Bfill%3A%230e6bb3%3Bfill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3B%7D%20%3C%2Fstyle%3E%3Cpath%20class%3D%22st0%22%20d%3D%22M12.5%200L0%2012l3%203%209.5-10L22%2015l3-3L12.5%200z%22%2F%3E%3C%2Fsvg%3E%0A');
        background-position: center right;
        background-size: 21px auto;
        background-repeat: no-repeat;
        transform: rotate(90deg);

        @include breakpoint($tab, $no-query: true) {
          top: .25em;
          right: -8px;
          background-size: 24px auto;
        }
      }
    }

    &__link {
      // link covers the entire card
      position: absolute;
      width: 100%;
      height: 100%;
      left: 0;
      top: 0;
      text-decoration: none;

      &:focus {
        outline: 3px solid $link;
        background-color: transparent;
        text-decoration: none;
      }
    }

    &__video {
      border: 0 solid;
      box-shadow: none;
      vertical-align: middle;

      &:hover {
        background-color: transparent;
        border-color: none;
      }
    }
  }

  &--x3 .card {

    @include breakpoint($tab, $no-query: true) {
      // Three cards in row.
      flex: 0 31.915%;
      max-width: 300px;
      //margin-right: 2.1277%;
      margin-bottom: 2.1277%;

      /*
      &:nth-child(3n + 3) { // Every third card
        margin-right: 0;
      }
      */
    }
  }

  &--x2 .card {

    @include breakpoint($tab, $no-query: true) {
      // Two cards in a row.
      flex: 0 48.9%;
      max-width: 460px;
    }
  }
}
